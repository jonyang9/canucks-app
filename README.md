## Pipeline
### Data Collection
First, I needed to find historical NHL data to train the model. The website https://www.naturalstattrick.com/ provides in-depth team statistics for past games, and I used pandas to fetch table data from the site. I checked the site's robot.txt file for web scraping guidelines, and they specified a crawl-delay of 240s. This means that I could only fetch a team's table every 4 minutes, and one season would take roughly 2 hours (32 teams x 4 minutes). On first run, the [feature_eng.py](/backend/src/pipeline/feature_eng.py) script will take a while, but it caches data to disk so future training runs quickly.

### Feature Selection and Engineering
A necessary class of features in sports prediction is rolling statistics - average statistics over the previous N games. Consider if we trained the model with the data as is, i.e the team statistics for a game as the set of features, and the outcome of the game as the label. Then, to predict the outcome of a future game, we would need to provide team statistics from the future game, but they don't exist yet! So in any sports prediction model, one cannot use a game to predict its own outcome. Including features that are not available at prediction time is one type of [data leakage](https://www.ibm.com/think/topics/data-leakage-machine-learning). To avoid this, all features are computed over a window of previous games.

I selected a subset of the original features that I believed would be the most predictive. Hockey is generally considered to have higher randomness than other sports, so I chose features that capture team dominance over outcomes that are influenced by luck. For example, I emphasized shots and scoring chances rather than actual goals, since shots indicate sustained offensive pressure, whereas goals can come from lucky bounces. I chose a window size of 10 games to balance capturing the recent strength of the team and smoothing out randomness of one-off games caused by luck. I added the same rolling statistics for the opposing team to learn how the Canucks play against different types of competition. In addition, I added context features such as home or away game for home ice advantages, and the number of days since the last game to capture fatigue effects.
